<div class="modal-backdrop" *ngIf="open">
  <div class="modal-popup">
    <h2>Sign Up</h2>
    <form [formGroup]="registerForm" (ngSubmit)="onRegister()">
      <div class="form-group">
        <label for="firstName">First Name</label>
        <input
          id="firstName"
          formControlName="firstName"
          type="text"
          required
        />
        <div
          class="error"
          *ngIf="
            registerForm.get('firstName')?.touched &&
            registerForm.get('firstName')?.invalid
          "
        >
          First name is required.
        </div>
      </div>
      <div class="form-group">
        <label for="lastName">Last Name</label>
        <input id="lastName" formControlName="lastName" type="text" required />
        <div
          class="error"
          *ngIf="
            registerForm.get('lastName')?.touched &&
            registerForm.get('lastName')?.invalid
          "
        >
          Last name is required.
        </div>
      </div>
      <div class="form-group">
        <label for="username">Username</label>
        <input id="username" formControlName="username" type="text" required />
        <div
          class="error"
          *ngIf="
            registerForm.get('username')?.touched &&
            registerForm.get('username')?.invalid
          "
        >
          Username is required (min 3 chars).
        </div>
      </div>
      <div class="form-group">
        <label for="email">Email</label>
        <input id="email" formControlName="email" type="email" required />
        <div
          class="error"
          *ngIf="
            registerForm.get('email')?.touched &&
            registerForm.get('email')?.invalid
          "
        >
          <span *ngIf="registerForm.get('email')?.errors?.['required']"
            >Email is required.</span
          >
          <span *ngIf="registerForm.get('email')?.errors?.['email']"
            >Enter a valid email.</span
          >
        </div>
      </div>
      <div class="form-group">
        <label for="phoneNumber">Phone Number</label>
        <input
          id="phoneNumber"
          formControlName="phoneNumber"
          type="tel"
          inputmode="tel"
          pattern="[0-9\-\+\(\) ]*"
          required
          maxlength="20"
          placeholder="(555) 555-5555"
        />
        <div
          class="error"
          *ngIf="
            registerForm.get('phoneNumber')?.touched &&
            registerForm.get('phoneNumber')?.invalid
          "
        >
          Phone number is required.
        </div>
      </div>
      <div class="form-group password-group">
        <label for="password">Password</label>
        <div class="password-wrapper">
          <input
            id="password"
            formControlName="password"
            [type]="showPassword ? 'text' : 'password'"
            required
          />
          <button
            type="button"
            class="eye-btn"
            (click)="toggleShowPassword()"
            tabindex="-1"
          >
            <span class="material-icons">{{
              showPassword ? "visibility_off" : "visibility"
            }}</span>
          </button>
        </div>
        <div
          class="error"
          *ngIf="
            registerForm.get('password')?.touched &&
            registerForm.get('password')?.invalid
          "
        >
          <span *ngIf="registerForm.get('password')?.errors?.['required']">
            Password is required.
          </span>
          <span *ngIf="registerForm.get('password')?.errors?.['minlength']">
            Password must be at least 8 characters.
          </span>
          <span *ngIf="registerForm.get('password')?.errors?.['pattern']">
            Password must contain at least 1 uppercase, 1 lowercase, 1 number,
            and 1 special character.
          </span>
        </div>
      </div>
      <div class="form-group password-group">
        <label for="confirmPassword">Confirm Password</label>
        <div class="password-wrapper">
          <input
            id="confirmPassword"
            formControlName="confirmPassword"
            [type]="showConfirmPassword ? 'text' : 'password'"
            required
          />
          <button
            type="button"
            class="eye-btn"
            (click)="toggleShowConfirmPassword()"
            tabindex="-1"
          >
            <span class="material-icons">{{
              showConfirmPassword ? "visibility_off" : "visibility"
            }}</span>
          </button>
        </div>
        <div
          class="error"
          *ngIf="
            registerForm.get('confirmPassword')?.touched &&
            registerForm.get('confirmPassword')?.invalid
          "
        >
          Confirm password is required.
        </div>
        <div
          class="error"
          *ngIf="registerForm.errors?.['passwordMismatch'] && registerForm.get('confirmPassword')?.touched"
        >
          Passwords do not match.
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-outline" (click)="onClose()">
          Cancel
        </button>
        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="registerForm.invalid || isLoading"
        >
          <span *ngIf="isLoading" class="spinner">
            <span class="material-icons spin">autorenew</span>
          </span>
          <span *ngIf="!isLoading">Register</span>
        </button>
      </div>
    </form>
  </div>
</div>
